# 過去メール移行手順書（IMAP方式）

## はじめに

この手順書は、Thunderbirdに保存されている過去のメールを、**Thunderbird上でExchange Onlineに直接コピー**する方法を説明します。

この方法では、ThunderbirdにExchange Onlineアカウントを一時的に追加し、ドラッグ＆ドロップでメールを移行します。

> **注意**: この作業は**任意**です。過去メールを移行しなくても、新しいメールの送受信には影響ありません。

---

## 目次

1. [この方法の特徴](#1-この方法の特徴)
2. [事前準備](#2-事前準備)
3. [Exchange OnlineアカウントをThunderbirdに追加](#3-exchange-onlineアカウントをthunderbirdに追加)
4. [メールの移行（ドラッグ＆ドロップ）](#4-メールの移行ドラッグドロップ)
5. [移行完了後の確認](#5-移行完了後の確認)
6. [Exchange Onlineアカウントの削除（重要）](#6-exchange-onlineアカウントの削除重要)
7. [トラブルシューティング](#7-トラブルシューティング)

---

## 1. この方法の特徴

### メリット

| メリット | 説明 |
|----------|------|
| **シンプル** | EMLファイルへのエクスポート不要 |
| **確実** | サーバーに直接コピーされる |
| **フォルダ構造維持** | フォルダごとコピー可能 |

### デメリット

| デメリット | 説明 |
|------------|------|
| **時間がかかる** | ネットワーク経由のため大量メールには不向き |
| **要サインアウト** | 作業後にアカウント削除が必要 |

### 推奨ケース

- 移行するメールが**500通以下**
- 特定のフォルダのみ移行したい
- EMLエクスポートがうまくいかない場合

---

## 2. 事前準備

### 2.1 必要なもの

| 項目 | 内容 |
|------|------|
| **Thunderbird** | 既存のメールが見える状態 |
| **Exchange Onlineアカウント情報** | メールアドレス、パスワード |
| **インターネット接続** | 安定した接続が必要 |

### 2.2 確認事項

- [ ] Thunderbirdで過去のメールが表示できる
- [ ] Exchange Onlineのメールアドレスとパスワードがわかる
- [ ] Outlookで新しいメールが送受信できている（Exchange Online設定済み）

---

## 3. Exchange OnlineアカウントをThunderbirdに追加

### 3.1 アカウント設定を開く

1. Thunderbirdを起動します
2. メニューボタン（**≡**）をクリック
3. 「**アカウント設定**」をクリック

### 3.2 新しいアカウントを追加

1. 画面左下の「**アカウント操作**」をクリック
2. 「**メールアカウントを追加**」を選択

### 3.3 アカウント情報を入力

以下の情報を入力します：

| 項目 | 入力内容 |
|------|----------|
| **あなたの名前** | 表示名（例：山田 太郎） |
| **メールアドレス** | Exchange Onlineのメールアドレス（例：yamada@example.co.jp） |
| **パスワード** | Exchange Onlineのパスワード |

入力したら「**続ける**」をクリックします。

### 3.4 手動設定（自動検出されない場合）

自動検出に失敗した場合は、「**手動設定**」をクリックして以下を入力します：

**受信サーバー（IMAP）**

| 項目 | 設定値 |
|------|--------|
| **プロトコル** | IMAP |
| **ホスト名** | outlook.office365.com |
| **ポート** | 993 |
| **接続の保護** | SSL/TLS |
| **認証方式** | OAuth2 |

**送信サーバー（SMTP）** ※移行作業では使用しませんが設定が必要です

| 項目 | 設定値 |
|------|--------|
| **ホスト名** | smtp.office365.com |
| **ポート** | 587 |
| **接続の保護** | STARTTLS |
| **認証方式** | OAuth2 |

### 3.5 認証（サインイン）

1. Microsoftのサインイン画面が表示されます
2. メールアドレスを確認して「**次へ**」
3. パスワードを入力して「**サインイン**」
4. 「**はい**」または「**承諾**」をクリック

### 3.6 追加完了の確認

- Thunderbirdの左側に**2つのアカウント**が表示されます：
  - 元のアカウント（移行元）
  - Exchange Onlineアカウント（移行先）

- Exchange Onlineの受信トレイが同期されるまで少し待ちます

---

## 4. メールの移行（ドラッグ＆ドロップ）

### 4.1 移行元フォルダを開く

1. 元のアカウント（移行元）を展開
2. 移行したいフォルダをクリック（例：受信トレイ）
3. メール一覧が表示されることを確認

### 4.2 メールを選択

**全てのメールを選択する場合：**
- メール一覧で **Ctrl + A** を押す

**一部のメールを選択する場合：**
- **Ctrl** を押しながらクリックで複数選択
- **Shift** を押しながらクリックで範囲選択

### 4.3 ドラッグ＆ドロップでコピー

1. 選択したメールをドラッグ
2. Exchange Onlineアカウントの対応するフォルダにドロップ
   - 例：受信トレイ → Exchange Onlineの受信トレイ

> **💡 ヒント**: 
> - ドロップ先のフォルダが青くハイライトされることを確認
> - 大量のメールは**100〜200件ずつ**に分けてコピー

### 4.4 コピー完了を待つ

- 画面下部に進捗が表示されます
- 「メッセージをコピー中...」が消えるまで待ちます
- **作業中はThunderbirdを閉じないでください**

### 4.5 他のフォルダも同様に移行

必要に応じて以下のフォルダも移行します：

- 送信済みトレイ → 送信済みアイテム
- 下書き → 下書き
- 個人フォルダ → （必要に応じて作成）

---

## 5. 移行完了後の確認

### 5.1 Thunderbirdで確認

1. Exchange Onlineアカウントの各フォルダを開く
2. コピーしたメールが表示されることを確認
3. いくつかのメールを開いて内容を確認

### 5.2 Outlookで確認

1. **Outlook**を起動
2. 受信トレイに移行したメールが表示されることを確認
3. 添付ファイルが正常に開けることを確認

### 5.3 確認項目チェックリスト

- [ ] 移行したメールがOutlookで表示される
- [ ] メールの日付が正しい
- [ ] 添付ファイルが開ける
- [ ] 日本語が文字化けしていない

---

## 6. Exchange Onlineアカウントの削除（重要）

移行作業が完了したら、**ThunderbirdからExchange Onlineアカウントを必ず削除**してください。

### 6.1 なぜ削除が必要か

| 理由 | 説明 |
|------|------|
| **セキュリティ** | 2つのアプリでログインしたままは推奨されない |
| **混乱防止** | どちらで操作すべきか混乱する |
| **リソース節約** | 同期処理が不要になる |

### 6.2 削除手順

1. Thunderbirdでメニューボタン（**≡**）をクリック
2. 「**アカウント設定**」をクリック
3. 左側で **Exchange Onlineアカウント**を選択
4. 画面左下の「**アカウント操作**」をクリック
5. 「**アカウントを削除**」を選択
6. 確認ダイアログで「**削除**」をクリック

### 6.3 削除後の確認

- Thunderbirdの左側からExchange Onlineアカウントが消えている
- 元のアカウント（ローカルメール）は残っている

> **注意**: アカウントを削除しても、Exchange Online上のメール（移行したメール）は**削除されません**。Outlookで引き続き利用できます。

---

## 7. トラブルシューティング

### Q1. アカウントが追加できない

**A**: 以下を確認してください：
1. メールアドレス・パスワードが正しいか
2. インターネット接続があるか
3. 手動設定でサーバー情報を入力してみる

### Q2. OAuth2認証でエラーになる

**A**: 以下を試してください：
1. Thunderbirdを最新版に更新
2. ブラウザでoutlook.office.comにログインできるか確認
3. 管理者に「先進認証」が有効か確認

### Q3. メールのコピーが途中で止まる

**A**: 以下を試してください：
1. 一度に選択するメール数を減らす（50件程度）
2. インターネット接続を確認
3. Thunderbirdを再起動して再試行

### Q4. コピー先にメールが表示されない

**A**: 以下を確認してください：
1. フォルダを右クリック →「新着メッセージを確認」
2. Exchange Onlineアカウントが同期中でないか確認
3. Outlookで確認（サーバー側を直接確認）

### Q5. 文字化けしている

**A**: 
- 古いメールで文字エンコードが異なる場合があります
- 重要なメールは元のThunderbirdで参照してください

### Q6. 削除したアカウントが復活する

**A**: 
1. Thunderbirdを完全に終了
2. 再度アカウント削除を実行
3. Thunderbirdを再起動

---

## 参考情報

### Exchange Online IMAP設定値

| 項目 | 受信（IMAP） | 送信（SMTP） |
|------|-------------|-------------|
| サーバー | outlook.office365.com | smtp.office365.com |
| ポート | 993 | 587 |
| 暗号化 | SSL/TLS | STARTTLS |
| 認証 | OAuth2 | OAuth2 |

### 移行後の運用

- **今後のメール**: Outlookを使用
- **過去メールの参照**: Outlookで可能（移行済み）
- **Thunderbird**: 必要がなければアンインストール可能

---

## お問い合わせ先

移行作業でお困りの場合は、システム管理者までお問い合わせください。

- **ヘルプデスク**: [メールアドレス/内線番号]
- **受付時間**: 平日 9:00〜18:00

---

## 改訂履歴

| 版 | 日付 | 変更内容 |
|---|------|----------|
| 1.0 | 2026/01/21 | 初版作成 |
